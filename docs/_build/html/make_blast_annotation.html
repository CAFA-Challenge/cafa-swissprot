
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Building CAFA Baseline Predictors &#8212; CAFA Swissprot Utilities  documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="this is my markdown file…" href="test.html" />
    <link rel="prev" title="Propagation Map Matrices" href="propagation_map.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="building-cafa-baseline-predictors">
<h1>Building CAFA Baseline Predictors<a class="headerlink" href="#building-cafa-baseline-predictors" title="Permalink to this headline">¶</a></h1>
<div class="section" id="naive-predictor">
<h2>Naive Predictor<a class="headerlink" href="#naive-predictor" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">annotation_filepath</span> <span class="o">=</span> <span class="s2">&quot;./input_annotation_for_blast_predictor.txt&quot;</span>
<span class="n">obo_filepath</span> <span class="o">=</span> <span class="s2">&quot;./go_cafa.obo&quot;</span>
<span class="n">namespace</span> <span class="o">=</span> <span class="s2">&quot;cellular_component&quot;</span>

<span class="n">naive_predictor</span> <span class="o">=</span> <span class="n">generate_naive_predictor</span><span class="p">(</span>
    <span class="n">annotation_filepath</span><span class="o">=</span><span class="n">annotation_filepath</span><span class="p">,</span>
    <span class="n">obo_filepath</span><span class="o">=</span><span class="n">obo_filepath</span><span class="p">,</span>
    <span class="n">namespace_verbose</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p><cite>generate_naive_predictor()</cite> returns a Pandas Series with GO terms as indices and
floating point numbers as values. Because the naive predictor is based solely on
GO term frequency, there is no protein data in the predictor pandas.Series. Instead,
<em>every</em> protein would have a predicted annotation at the given confidence level.</p>
<p>Here is a truncated output example for <cite>generate_naive_predictor()</cite>:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 52%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>GO Term</p></th>
<th class="head"><p>Confidence</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>GO:0000015</p></td>
<td><p>0.000000</p></td>
</tr>
<tr class="row-odd"><td><p>GO:0000109</p></td>
<td><p>0.000541</p></td>
</tr>
<tr class="row-even"><td><p>GO:0000110</p></td>
<td><p>0.000000</p></td>
</tr>
<tr class="row-odd"><td><p>GO:0000111</p></td>
<td><p>0.000000</p></td>
</tr>
<tr class="row-even"><td><p>GO:0000112</p></td>
<td><p>0.000000</p></td>
</tr>
<tr class="row-odd"><td><p>GO:0000113</p></td>
<td><p>0.000541</p></td>
</tr>
<tr class="row-even"><td><p>GO:0000118</p></td>
<td><p>0.000000</p></td>
</tr>
<tr class="row-odd"><td><p>GO:0000120</p></td>
<td><p>0.000000</p></td>
</tr>
<tr class="row-even"><td><p>GO:0000123</p></td>
<td><p>0.006490</p></td>
</tr>
<tr class="row-odd"><td><p>GO:0000124</p></td>
<td><p>0.001082</p></td>
</tr>
<tr class="row-even"><td><p>GO:0000125</p></td>
<td><p>0.000000</p></td>
</tr>
<tr class="row-odd"><td><p>GO:0000126</p></td>
<td><p>0.000000</p></td>
</tr>
<tr class="row-even"><td><p>GO:0000137</p></td>
<td><p>0.000000</p></td>
</tr>
<tr class="row-odd"><td><p>GO:0000138</p></td>
<td><p>0.000000</p></td>
</tr>
<tr class="row-even"><td><p>GO:0000139</p></td>
<td><p>0.002163</p></td>
</tr>
<tr class="row-odd"><td><p>GO:0000142</p></td>
<td><p>0.000541</p></td>
</tr>
<tr class="row-even"><td><p>…</p></td>
<td><p>…</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="blast-predictor">
<h2>Blast Predictor<a class="headerlink" href="#blast-predictor" title="Permalink to this headline">¶</a></h2>
<p>Generating a CAFA baseline Blast annotation requires a few things:</p>
<ol class="arabic simple">
<li><p>An OBO file</p></li>
<li><p>A Swissprot file</p></li>
<li><p>A file containing the output of a <cite>blastp</cite> query</p></li>
<li><p>a file containing a pickled Pandas DataFrame representing the GO ontology hierarchy</p></li>
</ol>
<p>Here’s a simple example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">OBO_FILEPATH</span> <span class="o">=</span> <span class="s1">&#39;./go_cafa.obo&#39;</span>
<span class="n">SPROT_FILEPATH</span> <span class="o">=</span> <span class="s1">&#39;./uniprot_sprot.dat&#39;</span>
<span class="n">BLASTP_SIMILARITY_FILEPATH</span> <span class="o">=</span> <span class="s1">&#39;./blastp.out&#39;</span>
<span class="n">PROPAGATION_MAP_FILEPATH</span> <span class="o">=</span> <span class="s1">&#39;./cco_propagation_map.pkl&#39;</span>
<span class="n">PROTEINS_OF_INTEREST</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;1A1L2_HUMAN&#39;</span><span class="p">,</span> <span class="s1">&#39;ZZEF1_HUMAN&#39;</span><span class="p">}</span>
<span class="n">ONTOLOGIES</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;CCO&#39;</span><span class="p">,}</span>

<span class="n">blast_generator</span> <span class="o">=</span> <span class="n">BlastPredictorGenerator</span><span class="p">(</span>
     <span class="n">blastp_results_filepath</span><span class="o">=</span><span class="n">BLASTP_SIMILARITY_FILEPATH</span><span class="p">,</span>
     <span class="n">swissprot_filepath</span><span class="o">=</span><span class="n">SPROT_FILEPATH</span><span class="p">,</span>
     <span class="n">propagation_map_filepath</span><span class="o">=</span><span class="n">PROPAGATION_MAP_FILEPATH</span><span class="p">,</span>
     <span class="n">obo_filepath</span><span class="o">=</span><span class="n">OBO_FILEPATH</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">blast_predictions</span> <span class="o">=</span> <span class="n">blast_generator</span><span class="o">.</span><span class="n">get_predictions</span><span class="p">(</span>
   <span class="n">query_protein_ids</span><span class="o">=</span><span class="n">PROTEINS_OF_INTEREST</span>
   <span class="n">ontology_namespaces</span><span class="o">=</span><span class="n">ONTOLOGIES</span>
<span class="p">)</span>
</pre></div>
</div>
<p><cite>get_predictions()</cite> will return a pandas.DataFrame with proteins as indices (rows)
and GO terms as columns. Values in the dataframe will be floating point numbers from 0 to 1
representing the confidence for the given annotation.</p>
<p>Here’s a truncated example of the resulting DataFrame:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 19%" />
<col style="width: 19%" />
<col style="width: 19%" />
<col style="width: 19%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Protein</p></th>
<th class="head"><p>GO:0000015</p></th>
<th class="head"><p>GO:0000109</p></th>
<th class="head"><p>GO:0000111</p></th>
<th class="head"><p>GO:0000124</p></th>
<th class="head"><p>…</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1A1L2_HUMAN</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-odd"><td><p>ZZEF1_HUMAN</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0.4</p></td>
<td><p>0.4</p></td>
<td><p>…</p></td>
</tr>
</tbody>
</table>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">CAFA Swissprot Utilities</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="propagation_map.html">Propagation Map Matrices</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Building CAFA Baseline Predictors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#naive-predictor">Naive Predictor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#blast-predictor">Blast Predictor</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="test.html">this is my markdown file…</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="propagation_map.html" title="previous chapter">Propagation Map Matrices</a></li>
      <li>Next: <a href="test.html" title="next chapter">this is my markdown file…</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.4.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/make_blast_annotation.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>